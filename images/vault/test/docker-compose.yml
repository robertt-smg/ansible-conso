
x-project:
  name: passbolt-test-vm

services:

  vault:
    # image:  hashicorp/vault
    image:  vault:latest

    environment:
      VAULT_ADDR: http://192.168.11.215:8200
      VAULT_API_ADDR: http://localhost:8200
      VAULT_LOCAL_CONFIGX: |
        storage "mysql" {
          address     = "fwplus.smg-air-conso.com:3306"
          username    = "vault"
          password    = "vault1234"
          database    = "vault"
          table       = "vault_kv_store"
        }

        listener "tcp" {
          address     = "0.0.0.0:8200"
          tls_disable = 1
        }

        disable_mlock = true
        ui = true

        # Predefined admin token
        default_lease_ttl = "168h"
        max_lease_ttl = "720h"
        api_addr = "http://localhost:8200"
        cluster_addr = "http://localhost:8201"
        admin_token = "my-predefined-admin-token"
    cap_add:
      - IPC_LOCK

    ports:
    - "127.0.0.215:8200:8200" # WebUI

    networks:
      salt-vm:
        ipv4_address: 192.168.11.215

networks:
  salt-vm:
     external: true

